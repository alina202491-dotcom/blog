---
// src/components/MusicPlayer.astro
//
// 【重大更新】
// 我们不再使用 MetingJS 来动态加载歌单，因为 API 请求似乎在你的环境中被阻止了。
// 现在，我们直接使用 APlayer，并将一个固定的歌曲列表嵌入到组件中。
// 这能确保播放器本身一定会被创建和显示。
---

<!-- 1. 直接引入 APlayer 的 CSS 文件 -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">

<!-- 2. 这是 APlayer 播放器将会挂载的 HTML 元素 -->
<div id="aplayer"></div>

<!-- 3. 直接引入 APlayer 的 JS 文件 -->
<script is:inline src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>

<!-- 4. 初始化 APlayer 的脚本 -->
<script is:inline>
  // 等待 DOM 加载完成后再初始化播放器
  document.addEventListener('DOMContentLoaded', function () {
    const ap = new APlayer({
      container: document.getElementById('aplayer'),
      fixed: true, // 固定在左下角
      mini: true, // 默认以迷你模式显示
      theme: '#2980b9', // 主题色
      lrcType: 1, // 启用歌词
      audio: [ // 【核心】这里是直接嵌入的歌曲列表
        {
          name: '离别开出花',
          artist: '就是南方凯',
          url: 'https://music.163.com/song/media/outer/url?id=2062653392.mp3',
          cover: 'https://p2.music.126.net/vC4s6n2gY-2yW9n0-NqY_A==/109951168819077984.jpg',
        },
        {
          name: '若月亮没来',
          artist: '王宇宙Leto / 乔浚丞',
          url: 'https://music.163.com/song/media/outer/url?id=2056598125.mp3',
          cover: 'https://p1.music.126.net/PJMfCo2I8gH5yLo2ol2iAA==/109951168725875681.jpg',
        },
        {
          name: '我会等',
          artist: '承桓',
          url: 'https://music.163.com/song/media/outer/url?id=2017750835.mp3',
          cover: 'https://p1.music.126.net/Nf2s35FotyNB8X5uY2d_9Q==/109951168285511203.jpg',
        }
      ]
    });
  });
</script>

<!--
  我们仍然保留这个强制样式，以确保播放器在最顶层显示。
  如果播放器正常出现，你可以删除这个 <style> 标签。
-->
<style is:global>
  .aplayer.aplayer-fixed {
    position: fixed !important;
    left: 15px !important;
    bottom: 15px !important;
    z-index: 2147483647 !important; /* 使用最高的 z-index */
    border: 2px solid lime !important; /* 添加一个亮绿色边框，方便一眼看到 */
  }
</style>
