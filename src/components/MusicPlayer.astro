---
// src/components/MusicPlayer.astro
// 【最终方案】
// 我们现在直接从你网站的 public 目录加载本地音乐文件。
// 这是最稳定、最可靠的方法，不会有任何网络或权限问题。
---

<!-- 1. 引入 APlayer 的 CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">

<!-- 2. APlayer 播放器的挂载点 -->
<div id="aplayer"></div>

<!-- 3. 引入 APlayer 的 JS -->
<script is:inline src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>

<!-- 4. 初始化 APlayer -->
<script is:inline>
  document.addEventListener('DOMContentLoaded', function () {
    // 检查 APlayer 是否已定义，以防万一
    if (typeof APlayer === 'undefined') {
      console.error('APlayer.js did not load.');
      return;
    }
    
    try {
      const ap = new APlayer({
        container: document.getElementById('aplayer'),
        fixed: true,
        mini: true,
        theme: '#2980b9',
        audio: [
          {
            name: '晴天',
            artist: '周杰伦',
            url: 'https://m-api.ceseet.me/url/wy/4875295/320k', // 直接使用你提供的API
            cover: 'https://iili.io/F4lPWkG.jpg',
          },
          {
            name: '七里香',
            artist: '周杰伦',
            url: 'https://m-api.ceseet.me/url/wy/189204/320k', // 直接使用你提供的API
            cover: 'https://iili.io/F4lPWkG.jpg',
          }
        ]
      });
    } catch (e) {
      console.error('Error initializing APlayer:', e);
    }
  });
</script>

<style is:global>
  .aplayer.aplayer-fixed {
    position: fixed !important;
    left: 15px !important;
    bottom: 15px !important;
    z-index: 2147483647 !important;
  }
</style>
