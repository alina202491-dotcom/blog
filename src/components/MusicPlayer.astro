---
// src/components/MusicPlayer.astro
//
// 【重大更新】
// 我们不再使用 MetingJS 来动态加载歌单，因为 API 请求似乎在你的环境中被阻止了。
// 现在，我们直接使用 APlayer，并将一个固定的歌曲列表嵌入到组件中。
// 这能确保播放器本身一定会被创建和显示。
---

<!-- 1. 直接引入 APlayer 的 CSS 文件 -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">

<!-- 2. 这是 APlayer 播放器将会挂载的 HTML 元素 -->
<div id="aplayer"></div>

<!-- 3. 直接引入 APlayer 的 JS 文件 -->
<script is:inline src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>

<!-- 4. 初始化 APlayer 的脚本 -->
<script is:inline>
  // 等待 DOM 加载完成后再初始化播放器
  document.addEventListener('DOMContentLoaded', function () {
    const ap = new APlayer({
      container: document.getElementById('aplayer'),
      fixed: true, // 固定在左下角
      mini: true, // 【修复】设置为 true，默认以最小化形式显示
      theme: '#2980b9', // 主题色
      lrcType: 1, // 启用歌词
      audio: [ // 这里是直接嵌入的歌曲列表
        {
          name: '夏天的风',
          artist: '温岚',
          url: 'https://cdn.jsdelivr.net/gh/honjun/honjun.github.io@master/music/4.mp3',
          cover: 'https://p2.music.126.net/wiVASu23g_wT34p-nI2TfQ==/109951163242941589.jpg',
        },
        {
          name: '晴天',
          artist: '周杰伦',
          url: 'https://cdn.jsdelivr.net/gh/honjun/honjun.github.io@master/music/1.mp3',
          cover: 'https://p2.music.126.net/t_9Z329g-4O9-A_2l9i1Gg==/109951164969299442.jpg',
        },
        {
          name: '七里香',
          artist: '周杰伦',
          url: 'https://cdn.jsdelivr.net/gh/honjun/honjun.github.io@master/music/2.mp3',
          cover: 'https://p1.music.126.net/w_U-p7-p-uQy_3-c7-P_9Q==/109951165885234562.jpg',
        }
      ]
    });
  });
</script>

<!--
  我们保留这个强制样式，以确保播放器在最顶层显示。
-->
<style is:global>
  .aplayer.aplayer-fixed {
    position: fixed !important;
    left: 15px !important;
    bottom: 15px !important;
    z-index: 2147483647 !important; /* 使用最高的 z-index */
  }
